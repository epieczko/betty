# Artifact Registry

This directory contains the central artifact registry for the Betty Framework.

## Files

### artifact_types.json
The **single source of truth** for all artifact type definitions. This file is loaded at runtime by `skills/artifact.define/artifact_define.py`.

**Structure:**
```json
{
  "version": "1.0.0",
  "generated_at": "ISO 8601 timestamp",
  "artifact_types": [
    {
      "name": "artifact-type-name",
      "description": "Human-readable description",
      "file_pattern": "*.pattern.{md,yaml}",
      "content_type": "text/markdown or application/yaml",
      "schema": "schemas/artifact-schema.json (optional)"
    }
  ]
}
```

**Adding a new artifact type:**
1. Add entry to `artifact_types` array in this file
2. Create description in `artifact_descriptions/{name}.md`
3. Optionally create JSON Schema in `schemas/artifacts/{name}-schema.json`
4. Run `python tools/audit_artifact_registry.py` to verify

### artifact_registry_audit.json
Comprehensive audit report showing:
- Registry consistency
- Missing artifact types
- Unused artifact types
- References across skills, agents, and templates

Generated by: `python tools/audit_artifact_registry.py`

## Workflow

### 1. Define New Artifact Type
Use the `meta.artifact` agent or add manually to `artifact_types.json`:

```bash
# Using meta.artifact agent
betty run meta.artifact create --description artifact_descriptions/my-type.md

# Or edit directly
vim registry/artifact_types.json
```

### 2. Validate Registry
Run the audit tool to ensure consistency:

```bash
python tools/audit_artifact_registry.py
```

### 3. Use Artifact Type
Reference the artifact in skill.yaml:

```yaml
artifact_metadata:
  produces:
    - type: my-artifact-type
      description: "What this produces"
```

## Data-Driven Approach

The registry follows a **data-driven** philosophy:
- ✅ Artifact types are defined in JSON (data)
- ✅ Code loads from JSON at runtime
- ❌ No hardcoded dictionaries in Python code
- ❌ No self-modifying source code

This enables:
- Version control of artifact definitions
- Easier auditing and validation
- Separation of concerns (data vs code)
- Runtime flexibility

## Automation

### Nightly CI
The audit tool should run in CI to catch inconsistencies:

```yaml
# .github/workflows/audit-registry.yml
- name: Audit Artifact Registry
  run: python tools/audit_artifact_registry.py
```

### Pre-commit Hook
Validate registry on commit:

```yaml
# .claude-code/hooks.yaml
before-commit:
  - command: python tools/audit_artifact_registry.py
    description: Validate artifact registry consistency
```

## Maintenance

- **Owner:** Betty Framework Core Team
- **Review Cycle:** Quarterly
- **Last Audit:** Check `artifact_registry_audit.json` for timestamp
- **Documentation:** See `docs/ARTIFACT_STANDARDS.md`
