policy:
  name: no-secrets
  version: 0.1.0
  description: Prevents hardcoded secrets, API keys, and credentials in code and configuration
    files.
  type: security
  scope:
  - artifact
  rules:
  - description: AWS Access Keys
    pattern: (A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}
    action: block
    severity: error
    message: AWS Access Keys
  - description: API Keys and Tokens
    pattern: (api[_-]?key|apikey|api[_-]?token|access[_-]?token|auth[_-]?token)\s*[:=]\s*["\'][\w-]{20,}["\']
    action: block
    severity: error
    message: API Keys and Tokens
  - description: Generic Secrets
    pattern: (password|passwd|pwd|secret)\s*[:=]\s*["\'][^"\']{8,}["\']
    action: block
    severity: error
    message: Generic Secrets
  - description: Private Keys
    pattern: '-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----'
    action: block
    severity: error
    message: Private Keys
  - description: Database Connection Strings
    pattern: (mysql|postgresql|mongodb):\/\/[^:]+:[^@]+@
    action: block
    severity: error
    message: Database Connection Strings
  enforcement: blocking
