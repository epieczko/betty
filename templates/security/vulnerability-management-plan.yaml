# Vulnerability Management Plan
# See also: artifact_descriptions/vulnerability-management-plan.md for complete guidance

metadata:
  version: "1.0.0"
  documentId: "VMP-2024-001"
  created: "YYYY-MM-DD"
  lastModified: "YYYY-MM-DD"
  nextReviewDate: "YYYY-MM-DD"  # Annual review recommended
  status: "Draft"  # Draft | Review | Approved | Published

  # Ownership
  author: "Security Operations Team"
  documentOwner: "CISO / VP Security"
  stakeholders:
    - "Security Operations Center (SOC)"
    - "IT Operations / Infrastructure Team"
    - "Development / Engineering Teams"
    - "DevSecOps Team"
    - "Cloud Operations Team"
    - "Compliance / GRC Team"

  classification: "Internal"  # May contain sensitive security information
  complianceFrameworks: ["NIST SP 800-40", "ISO 27001", "PCI-DSS 4.0", "SOC 2 Type II"]

# ============================================================================
# EXECUTIVE SUMMARY
# ============================================================================

executiveSummary: |
  This Vulnerability Management Plan establishes a continuous, risk-based process for
  identifying, assessing, prioritizing, remediating, and tracking security vulnerabilities
  across our infrastructure, applications, containers, and cloud environments.

  Scope: All production and non-production systems, applications, and cloud resources
  Methodology: NIST SP 800-40, CVSS 3.1 scoring, risk-based prioritization
  SLA Compliance: 95% of critical vulns remediated within 7 days, 90% high within 30 days

  Key Metrics (Last Quarter):
  - Total vulnerabilities identified: 2,847
  - Critical remediated on time: 98% (Target: 95%)
  - High remediated on time: 92% (Target: 90%)
  - Mean time to remediate (MTTR) - Critical: 4.2 days (Target: <7 days)

# ============================================================================
# 1. PROGRAM OVERVIEW
# ============================================================================

program:
  objectives:
    - "Continuously identify vulnerabilities across entire attack surface"
    - "Prioritize vulnerabilities based on CVSS score, exploitability, and business context"
    - "Remediate critical/high vulnerabilities within defined SLAs"
    - "Reduce organizational risk exposure and attack surface"
    - "Maintain compliance with regulatory vulnerability management requirements"
    - "Enable proactive security posture vs. reactive incident response"

  scope:
    coverage:
      - "Operating systems (Linux, Windows, macOS)"
      - "Network devices (routers, switches, firewalls, load balancers)"
      - "Web applications (internal and customer-facing)"
      - "APIs (REST, GraphQL, gRPC)"
      - "Databases (PostgreSQL, MySQL, MongoDB, Redis)"
      - "Containers and container images"
      - "Kubernetes clusters"
      - "Cloud infrastructure (AWS, Azure, GCP)"
      - "IaaS, PaaS, SaaS services"
      - "Third-party libraries and dependencies"
      - "Mobile applications (iOS, Android)"
      - "IoT and embedded devices"

    environments:
      - name: "Production"
        priority: "Critical"
        scanFrequency: "Weekly"
        patchWindow: "Emergency patches: immediate, Scheduled: monthly"

      - name: "Staging"
        priority: "High"
        scanFrequency: "Weekly"
        patchWindow: "Before production deployment"

      - name: "Development"
        priority: "Medium"
        scanFrequency: "Monthly"
        patchWindow: "Quarterly"

      - name: "QA/Testing"
        priority: "Medium"
        scanFrequency: "Bi-weekly"
        patchWindow: "Aligned with dev cycle"

    outOfScope:
      - "Vendor-managed SaaS platforms (Salesforce, Workday) - vendor responsibility"
      - "Employee personal devices (BYOD) - covered by Endpoint Security Policy"
      - "Partner/customer-owned systems - covered by Third-Party Risk Management"
      - "Physical security systems - covered by Physical Security Plan"

  governanceModel:
    vulnerabilityManagementBoard:
      chair: "CISO"
      members: ["VP Engineering", "VP Infrastructure", "Security Director", "Compliance Manager"]
      cadence: "Monthly"
      responsibilities:
        - "Review vulnerability management metrics and trends"
        - "Approve risk exceptions for vulnerabilities exceeding SLA"
        - "Allocate resources for critical remediation efforts"
        - "Update vulnerability management policy and procedures"

# ============================================================================
# 2. ROLES & RESPONSIBILITIES
# ============================================================================

rolesResponsibilities:
  - role: "CISO / VP Security"
    responsibilities:
      - "Executive sponsorship and budget allocation"
      - "Final approval on risk exceptions"
      - "Board/executive reporting on vulnerability posture"

  - role: "Security Operations Team"
    responsibilities:
      - "Execute vulnerability scanning per schedule"
      - "Triage and assign vulnerabilities to remediation owners"
      - "Track remediation progress and SLA compliance"
      - "Generate vulnerability reports and dashboards"
      - "Manage vulnerability scanning tools and licenses"

  - role: "IT Operations / Infrastructure Team"
    responsibilities:
      - "Remediate infrastructure vulnerabilities (OS, network, database)"
      - "Apply patches and updates to servers, network devices"
      - "Test patches in non-production before production deployment"
      - "Coordinate maintenance windows for patching"

  - role: "Development / Engineering Teams"
    responsibilities:
      - "Remediate application code vulnerabilities (SAST/DAST findings)"
      - "Update vulnerable third-party libraries and dependencies"
      - "Integrate vulnerability scanning into CI/CD pipeline"
      - "Participate in secure code training"

  - role: "DevSecOps Team"
    responsibilities:
      - "Implement and maintain vulnerability scanning in CI/CD"
      - "Container image scanning and hardening"
      - "Infrastructure-as-Code security scanning"
      - "Automate vulnerability reporting and remediation workflows"

  - role: "Cloud Operations Team"
    responsibilities:
      - "Remediate cloud infrastructure vulnerabilities"
      - "Configure Cloud Security Posture Management (CSPM) tools"
      - "Implement cloud-native security controls"
      - "Manage cloud service provider security updates"

  - role: "Asset Owners / Business Units"
    responsibilities:
      - "Approve remediation plans for business-critical systems"
      - "Provide business context for vulnerability prioritization"
      - "Accept residual risk for non-remediable vulnerabilities"

# ============================================================================
# 3. VULNERABILITY IDENTIFICATION
# ============================================================================

identification:
  scanningSchedule:
    infrastructure:
      - assetType: "Production Servers (Linux/Windows)"
        tool: "Tenable Nessus Professional"
        frequency: "Weekly (automated)"
        scanType: "Credentialed"
        schedule: "Every Sunday 2:00 AM ET"

      - assetType: "Network Devices"
        tool: "Qualys VMDR"
        frequency: "Monthly"
        scanType: "Non-credentialed"
        schedule: "First Saturday of month"

      - assetType: "Databases"
        tool: "Tenable Nessus + Custom Scripts"
        frequency: "Weekly"
        scanType: "Credentialed"
        schedule: "Every Sunday 3:00 AM ET"

      - assetType: "External Perimeter (Public IPs)"
        tool: "Qualys External Scanning"
        frequency: "Weekly"
        scanType: "Non-credentialed"
        compliance: "PCI-DSS Requirement 11.2.2 (quarterly minimum)"

    applications:
      - assetType: "Web Applications (Production)"
        tool: "Burp Suite Enterprise + OWASP ZAP"
        frequency: "Weekly DAST"
        schedule: "Every Friday 10:00 PM ET"

      - assetType: "APIs"
        tool: "Postman + Custom API Scanner"
        frequency: "Bi-weekly"
        scanType: "Authenticated API testing"

      - assetType: "Source Code (SAST)"
        tool: "SonarQube + Semgrep"
        frequency: "Every commit (CI/CD integrated)"
        coverage: "All repositories"

      - assetType: "Third-Party Dependencies (SCA)"
        tool: "Snyk + Dependabot"
        frequency: "Daily"
        alerts: "Real-time alerts for new vulnerabilities"

    containers:
      - assetType: "Container Images"
        tool: "Trivy + Aqua Security"
        frequency: "On build + Daily registry scan"
        policy: "Block critical/high vulns from production deployment"

      - assetType: "Kubernetes Clusters"
        tool: "Prisma Cloud + kube-bench"
        frequency: "Daily"
        scope: "Configuration and runtime vulnerabilities"

    cloud:
      - assetType: "AWS Infrastructure"
        tool: "AWS Security Hub + Prowler"
        frequency: "Continuous (real-time)"
        checks: "CIS AWS Foundations Benchmark"

      - assetType: "Azure Infrastructure"
        tool: "Azure Security Center + Defender for Cloud"
        frequency: "Continuous"
        scope: "Compute, storage, network, identity"

      - assetType: "GCP Infrastructure"
        tool: "GCP Security Command Center"
        frequency: "Continuous"
        coverage: "All GCP projects"

  scanningCredentials:
    managementProcess: |
      - Scanning credentials stored in HashiCorp Vault
      - Least privilege: read-only access for scanning
      - Credentials rotated quarterly
      - Separate service accounts per scanning tool
      - MFA required for credential vault access

    windows:
      account: "DOMAIN\\svc_nessus_scan"
      permissions: "Local Administrator (read-only equivalent via GPO)"
      passwordRotation: "90 days"

    linux:
      account: "nessus_scanner"
      permissions: "sudo with NOPASSWD for specific commands (via sudoers)"
      sshKey: "Rotated quarterly"

# ============================================================================
# 4. VULNERABILITY ASSESSMENT & SCORING
# ============================================================================

assessment:
  scoringMethodology:
    primary: "CVSS 3.1"
    supplementary:
      - "EPSS (Exploit Prediction Scoring System) for exploitability likelihood"
      - "CISA KEV (Known Exploited Vulnerabilities) catalog for active exploitation"
      - "VPR (Vulnerability Priority Rating) from Tenable"
      - "Asset criticality (business impact)"

  cvssScoring:
    vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    metrics:
      attackVector: ["Network", "Adjacent", "Local", "Physical"]
      attackComplexity: ["Low", "High"]
      privilegesRequired: ["None", "Low", "High"]
      userInteraction: ["None", "Required"]
      scope: ["Unchanged", "Changed"]
      confidentialityImpact: ["None", "Low", "High"]
      integrityImpact: ["None", "Low", "High"]
      availabilityImpact: ["None", "Low", "High"]

    severityRanges:
      - severity: "Critical"
        cvssRange: "9.0 - 10.0"
        colorCode: "Red"

      - severity: "High"
        cvssRange: "7.0 - 8.9"
        colorCode: "Orange"

      - severity: "Medium"
        cvssRange: "4.0 - 6.9"
        colorCode: "Yellow"

      - severity: "Low"
        cvssRange: "0.1 - 3.9"
        colorCode: "Blue"

      - severity: "Informational"
        cvssRange: "0.0"
        colorCode: "Green"

  prioritizationFramework:
    factors:
      - factor: "CVSS Base Score"
        weight: 40
        description: "Inherent severity of vulnerability"

      - factor: "Exploitability (EPSS)"
        weight: 25
        description: "Likelihood of exploitation in the wild"

      - factor: "Asset Criticality"
        weight: 20
        description: "Business importance of affected asset"
        levels:
          - "Tier 1 - Critical: Revenue-generating production systems"
          - "Tier 2 - High: Customer-facing but non-revenue systems"
          - "Tier 3 - Medium: Internal corporate systems"
          - "Tier 4 - Low: Development/testing systems"

      - factor: "Data Sensitivity"
        weight: 10
        description: "Classification of data on affected system"
        levels:
          - "Restricted: PHI, PCI, financial data"
          - "Confidential: Customer PII, proprietary data"
          - "Internal: Business data"
          - "Public: No sensitive data"

      - factor: "Internet Exposure"
        weight: 5
        description: "External vs. internal asset"

  automatedPrioritization:
    tool: "Tenable Vulnerability Priority Rating (VPR)"
    formula: |
      Priority Score = (CVSS * 0.4) + (EPSS * 0.25) + (Asset Criticality * 0.2) +
                       (Data Sensitivity * 0.1) + (Internet Exposure * 0.05)

    thresholds:
      - priority: "P0 - Emergency"
        scoreRange: "9.0+"
        condition: "Critical CVSS + CISA KEV + Internet-facing production"
        example: "CVE-2021-44228 (Log4Shell)"

      - priority: "P1 - Urgent"
        scoreRange: "7.5 - 8.9"
        condition: "High CVSS + Exploitable + Tier 1/2 asset"

      - priority: "P2 - High"
        scoreRange: "5.0 - 7.4"
        condition: "Medium-High CVSS + Tier 1/2 asset OR High CVSS + Tier 3"

      - priority: "P3 - Medium"
        scoreRange: "3.0 - 4.9"
        condition: "Medium CVSS OR High CVSS + Tier 4 asset"

      - priority: "P4 - Low"
        scoreRange: "0.1 - 2.9"
        condition: "Low CVSS scores"

# ============================================================================
# 5. REMEDIATION SLAS
# ============================================================================

remediationSLAs:
  - severity: "Critical"
    cvssRange: "9.0 - 10.0"
    sla: "7 calendar days"
    priority: "P0"
    escalationPath: "Day 3: Manager, Day 5: Director, Day 7: VP/CISO"
    compensatingControl: "If patch unavailable: WAF rule, IPS signature, network isolation"
    exampleVulnerabilities:
      - "CVE-2021-44228 (Log4Shell) - CVSS 10.0"
      - "CVE-2023-23397 (Outlook RCE) - CVSS 9.8"
      - "Unauthenticated RCE on internet-facing production system"

  - severity: "High"
    cvssRange: "7.0 - 8.9"
    sla: "30 calendar days"
    priority: "P1"
    escalationPath: "Day 15: Manager, Day 25: Director"
    compensatingControl: "WAF rules, network segmentation, enhanced monitoring"
    exampleVulnerabilities:
      - "SQL injection in web application"
      - "Privilege escalation vulnerability"
      - "Authentication bypass"

  - severity: "Medium"
    cvssRange: "4.0 - 6.9"
    sla: "90 calendar days"
    priority: "P2"
    escalationPath: "Day 60: Manager notification"
    compensatingControl: "Assess risk; may defer if low exploitability"
    exampleVulnerabilities:
      - "Cross-site scripting (XSS)"
      - "Information disclosure"
      - "Weak encryption ciphers"

  - severity: "Low"
    cvssRange: "0.1 - 3.9"
    sla: "180 calendar days or next maintenance window"
    priority: "P3"
    escalationPath: "None (tracked in backlog)"
    compensatingControl: "Accept risk if remediation cost > risk"
    exampleVulnerabilities:
      - "Missing security headers"
      - "Verbose error messages"
      - "End-of-life software with no direct exploit path"

  emergencyPatchProcess:
    trigger: "CISA KEV listing OR active exploitation in the wild OR CVSS 10.0"
    timeline:
      - "Hour 0: Vulnerability identified and confirmed"
      - "Hour 2: Emergency response team mobilized"
      - "Hour 4: Patch testing in non-production"
      - "Hour 8: Emergency Change Advisory Board (eCAB) approval"
      - "Hour 12: Production deployment begins"
      - "Hour 24: Deployment complete and verified"
    approval: "CISO + VP Engineering (verbal approval acceptable, documented later)"
    rollback: "Automated rollback if critical functionality impaired"

# ============================================================================
# 6. REMEDIATION METHODS
# ============================================================================

remediationMethods:
  patching:
    - method: "Apply Vendor Patch"
      preference: "Primary"
      description: "Install official security patch from vendor"
      timeline: "Per SLA based on severity"
      validation: "Re-scan to confirm vuln no longer detected"
      example: "yum update openssl or apt-get install --security-only"

    - method: "Version Upgrade"
      preference: "Secondary"
      description: "Upgrade to newer version containing fix"
      timeline: "Per SLA + regression testing"
      validation: "Full regression testing in staging"
      example: "Upgrade Node.js 14 (EOL) to Node.js 20 (LTS)"

    - method: "Configuration Change"
      preference: "Alternative"
      description: "Disable vulnerable feature or harden configuration"
      timeline: "Faster than patching (hours)"
      validation: "Configuration audit + functionality testing"
      example: "Disable TLS 1.0/1.1, enable HSTS"

    - method: "Dependency Update"
      preference: "Primary (for libraries)"
      description: "Update vulnerable npm/pip/Maven dependency"
      timeline: "Per SLA + regression testing"
      validation: "Automated tests + SAST scan"
      example: "npm update lodash@4.17.21 (fixes prototype pollution)"

  compensatingControls:
    - control: "Web Application Firewall (WAF) Rule"
      useCase: "Patch not yet available for web application vulnerability"
      implementation: "Deploy virtual patch blocking exploit signature"
      effectiveness: "High for known exploit patterns"
      maintenance: "Remove WAF rule after permanent patch deployed"
      example: "ModSecurity rule for CVE-2021-44228 (Log4Shell)"

    - control: "Intrusion Prevention System (IPS) Signature"
      useCase: "Network-based exploitation attempt"
      implementation: "Deploy IPS rule blocking exploit traffic"
      effectiveness: "High for signature-based attacks"
      maintenance: "Keep signature database updated"

    - control: "Network Segmentation"
      useCase: "Cannot patch legacy system"
      implementation: "Isolate vulnerable system on restricted VLAN"
      effectiveness: "Reduces blast radius, prevents lateral movement"
      maintenance: "Periodic access review"
      example: "SCADA/ICS systems on air-gapped network"

    - control: "Enhanced Monitoring & Alerting"
      useCase: "Exploitation detection for non-patchable systems"
      implementation: "SIEM rules, EDR alerts, log analysis"
      effectiveness: "Detective control (not preventive)"
      maintenance: "Tune alerts to reduce false positives"

    - control: "Access Control Restrictions"
      useCase: "Limit attack surface"
      implementation: "Firewall rules, VPN requirement, IP allowlisting"
      effectiveness: "Reduces likelihood of exploitation"
      example: "Require VPN for accessing admin panel"

  codeRemediation:
    process: |
      1. Developer receives vulnerability assignment in Jira
      2. Developer creates feature branch for fix
      3. Implement fix using secure coding guidelines
      4. Run SAST scan to verify fix (SonarQube, Semgrep)
      5. Submit pull request with security review label
      6. Security team approves PR (or provides feedback)
      7. Merge to main branch
      8. CI/CD pipeline automatically deploys to staging
      9. QA team validates fix in staging
      10. Production deployment (standard or emergency process)
      11. Re-scan production to confirm remediation

    secureGuidance:
      - "OWASP Top 10 remediation guidance"
      - "CWE (Common Weakness Enumeration) mitigation strategies"
      - "Language-specific security best practices (OWASP Cheat Sheets)"
      - "Internal secure coding standards"

# ============================================================================
# 7. RISK EXCEPTION PROCESS
# ============================================================================

exceptions:
  criteria:
    acceptable:
      - "No patch available from vendor and compensating controls in place"
      - "Patch causes critical business functionality failure (with risk acceptance)"
      - "Legacy end-of-life system scheduled for decommission within 90 days"
      - "Vulnerability requires local access + multi-factor conditions (low likelihood)"
      - "False positive confirmed by security team and vendor"

    notAcceptable:
      - "Convenience or effort required to remediate"
      - "Lack of resources or budget"
      - "Concerns about patch stability without testing"
      - "Critical/high vulnerabilities on internet-facing production systems (except with CISO approval)"

  process:
    - step: 1
      action: "Asset owner submits exception request"
      form: "Vulnerability Exception Request Form (Jira Service Desk)"
      requiredInfo:
        - "Vulnerability ID (CVE or scanner finding ID)"
        - "Business justification"
        - "Compensating controls implemented"
        - "Residual risk assessment"
        - "Proposed exception duration (max 90 days)"

    - step: 2
      action: "Security team reviews exception"
      reviewer: "Security Operations Manager"
      timeline: "3 business days"
      criteria:
        - "Compensating controls adequate"
        - "Residual risk acceptable"
        - "Documentation complete"

    - step: 3
      action: "Risk committee approval"
      approvers:
        - severity: "Critical/High"
          approver: "CISO"
        - severity: "Medium"
          approver: "Director of Security"
        - severity: "Low"
          approver: "Security Operations Manager"

    - step: 4
      action: "Exception logged and tracked"
      system: "GRC platform (ServiceNow GRC)"
      review: "Monthly exception review by Vulnerability Management Board"
      expiration: "Auto-expire after approved duration, require re-approval"

  tracking:
    - exceptionId: "VE-2024-0015"
      vulnerability: "CVE-2019-0708 (BlueKeep RDP RCE)"
      affectedAsset: "Legacy Windows Server 2008 R2 (hostname: LEGACYAPP01)"
      severity: "Critical (CVSS 9.8)"
      justification: "Application requires Windows Server 2008 R2; vendor patch breaks app functionality"
      compensatingControls:
        - "RDP disabled (port 3389 blocked at firewall)"
        - "Access only via VPN + bastion host"
        - "Network segmentation (isolated VLAN)"
        - "Enhanced monitoring with SIEM alerts"
      approver: "CISO"
      approvalDate: "2024-03-15"
      expirationDate: "2024-06-15"
      reviewSchedule: "Monthly"
      decommissionPlan: "Application migration to containerized platform by Q3 2024"
      status: "Active"

# ============================================================================
# 8. VULNERABILITY TRACKING & REPORTING
# ============================================================================

tracking:
  tool: "ServiceNow Vulnerability Response (VR)"
  integration:
    - "Tenable.io API -> ServiceNow (automatic vuln import)"
    - "Snyk -> Jira (code vulnerability tickets)"
    - "AWS Security Hub -> Splunk SIEM (cloud vulns)"

  workflow:
    - status: "New"
      description: "Vulnerability identified by scanner"
      owner: "Security Operations"
      actions: ["Initial triage", "False positive check", "Assign to remediation owner"]

    - status: "Assigned"
      description: "Assigned to asset owner for remediation"
      owner: "IT Ops / Dev Team / Cloud Ops"
      actions: ["Acknowledge", "Plan remediation", "Update status"]

    - status: "In Progress"
      description: "Remediation work underway"
      owner: "Remediation team"
      actions: ["Apply patch/fix", "Test", "Request verification scan"]

    - status: "Remediated"
      description: "Fix deployed to production"
      owner: "Security Operations"
      actions: ["Re-scan", "Verify closure"]

    - status: "Closed"
      description: "Vulnerability no longer detected"
      owner: "Security Operations"
      actions: ["Archive", "Update metrics"]

    - status: "Risk Accepted"
      description: "Exception approved"
      owner: "Risk Committee"
      actions: ["Document compensating controls", "Set review date"]

    - status: "False Positive"
      description: "Scanner error or non-exploitable"
      owner: "Security Operations"
      actions: ["Document justification", "Configure scanner exception"]

reporting:
  executiveDashboard:
    frequency: "Monthly"
    audience: "C-Suite, Board of Directors"
    metrics:
      - "Total open vulnerabilities by severity"
      - "SLA compliance percentage (last 90 days)"
      - "Mean time to remediate (MTTR) by severity"
      - "Vulnerability trend (month-over-month)"
      - "Top 10 vulnerability types"
      - "Risk exposure score (aggregate CVSS * asset count)"

  operationalReports:
    - report: "Weekly Vulnerability Summary"
      audience: "Security Ops, IT Ops"
      content:
        - "New critical/high vulnerabilities requiring immediate action"
        - "Vulnerabilities approaching SLA deadline"
        - "Remediation progress by team"

    - report: "Monthly Metrics Report"
      audience: "Security leadership"
      content:
        - "Vulnerabilities by severity and status"
        - "SLA compliance by team"
        - "MTTR trend analysis"
        - "Exception status and review"
        - "Scan coverage (% of assets scanned)"

    - report: "Quarterly Trend Analysis"
      audience: "CISO, Risk Committee"
      content:
        - "Vulnerability trends over time"
        - "Emerging vulnerability types"
        - "Remediation efficiency improvements"
        - "Benchmark comparison (industry standards)"

  complianceReports:
    - framework: "PCI-DSS 4.0"
      requirement: "Requirement 11.2 (Quarterly Vulnerability Scans)"
      evidence:
        - "Quarterly ASV scans (external)"
        - "Quarterly internal scans"
        - "Remediation reports for critical/high findings"

    - framework: "SOC 2 Type II"
      control: "CC7.1 (Vulnerability Management)"
      evidence:
        - "Vulnerability scanning schedule"
        - "SLA compliance metrics"
        - "Exception approvals and compensating controls"

    - framework: "ISO 27001"
      control: "A.12.6.1 (Technical Vulnerability Management)"
      evidence:
        - "Vulnerability management policy"
        - "Scanning and remediation records"
        - "Asset inventory"

# ============================================================================
# 9. METRICS & KPIs
# ============================================================================

metrics:
  - metric: "Mean Time to Remediate (MTTR)"
    definition: "Average days from vulnerability identification to closure"
    target:
      critical: "<7 days"
      high: "<30 days"
      medium: "<90 days"
      low: "<180 days"
    calculation: "SUM(remediation_date - discovery_date) / COUNT(vulnerabilities)"
    reportingFrequency: "Weekly"

  - metric: "SLA Compliance Rate"
    definition: "Percentage of vulnerabilities remediated within SLA"
    target:
      critical: "95%"
      high: "90%"
      medium: "85%"
      low: "80%"
    calculation: "(Vulns closed within SLA / Total vulns) * 100"
    reportingFrequency: "Monthly"

  - metric: "Vulnerability Density"
    definition: "Average vulnerabilities per asset"
    target: "<5 medium+ vulns per asset"
    calculation: "Total open vulnerabilities / Total assets scanned"
    reportingFrequency: "Monthly"

  - metric: "Scan Coverage"
    definition: "Percentage of assets scanned per schedule"
    target: "95%+ of production assets scanned weekly"
    calculation: "(Assets scanned / Total production assets) * 100"
    reportingFrequency: "Weekly"

  - metric: "Time to Detection"
    definition: "Days between vulnerability disclosure and identification in environment"
    target: "<7 days for critical CVEs"
    calculation: "Discovery_date - CVE_published_date"
    reportingFrequency: "Monthly"

  - metric: "Risk Exposure Score"
    definition: "Weighted risk based on CVSS and asset count"
    target: "Trend downward month-over-month"
    calculation: "SUM(CVSS_score * asset_count) for all open vulns"
    reportingFrequency: "Monthly"

  - metric: "Recurring Vulnerabilities"
    definition: "Same vulnerability type reappearing after remediation"
    target: "<5% recurrence rate"
    calculation: "(Re-opened vulns / Total closed vulns) * 100"
    reportingFrequency: "Quarterly"

  - metric: "Exception Rate"
    definition: "Percentage of vulnerabilities with risk acceptance"
    target: "<10% of critical/high vulns"
    calculation: "(Vulns with exceptions / Total vulns) * 100"
    reportingFrequency: "Monthly"

# ============================================================================
# 10. TOOLS & TECHNOLOGIES
# ============================================================================

tools:
  infrastructureScanning:
    - tool: "Tenable Nessus Professional"
      version: "10.x"
      coverage: "Servers, workstations, network devices"
      deployment: "On-premise scanners in each datacenter"
      licensing: "500 assets"
      credentialedScanning: true

    - tool: "Qualys VMDR"
      version: "SaaS"
      coverage: "External perimeter, PCI environment"
      deployment: "Cloud-based + on-premise appliances"
      licensing: "Unlimited external + 1000 internal IPs"
      pciCompliance: true

  applicationScanning:
    - tool: "Burp Suite Enterprise"
      version: "2024.x"
      coverage: "Web applications"
      integration: "CI/CD pipeline (GitHub Actions)"
      licensing: "50 applications"

    - tool: "SonarQube Enterprise"
      version: "10.x"
      coverage: "Source code (SAST)"
      languages: ["Java", "JavaScript", "Python", "Go", "C#"]
      integration: "Every commit"

    - tool: "Snyk"
      version: "SaaS"
      coverage: "Open source dependencies (SCA)"
      integration: "GitHub, npm, PyPI, Maven"
      alerts: "Real-time Slack notifications"

  containerScanning:
    - tool: "Trivy"
      version: "0.48.x"
      coverage: "Container images, IaC, Kubernetes"
      integration: "Docker build, CI/CD, Kubernetes admission controller"
      licensing: "Open source"

    - tool: "Aqua Security"
      version: "2024.x"
      coverage: "Runtime protection, image scanning"
      deployment: "Kubernetes DaemonSet"

  cloudScanning:
    - tool: "AWS Security Hub"
      coverage: "AWS infrastructure"
      standards: ["CIS AWS Foundations", "PCI-DSS", "AWS Foundational Security Best Practices"]
      integration: "EventBridge -> Lambda -> Jira"

    - tool: "Prisma Cloud"
      coverage: "Multi-cloud (AWS, Azure, GCP)"
      features: ["CSPM", "CWPP", "Container security"]

  orchestration:
    - tool: "ServiceNow Vulnerability Response"
      purpose: "Centralized vulnerability tracking and workflow"
      integration: "All scanners -> ServiceNow"

    - tool: "Splunk SIEM"
      purpose: "Vulnerability analytics and threat correlation"
      integration: "All security tools -> Splunk"

# ============================================================================
# 11. CONTINUOUS IMPROVEMENT
# ============================================================================

continuousImprovement:
  maturityModel:
    - level: 1
      name: "Initial / Ad-hoc"
      characteristics:
        - "Reactive scanning (only after incidents)"
        - "No defined process or SLAs"
        - "Manual tracking in spreadsheets"
      currentState: false

    - level: 2
      name: "Developing"
      characteristics:
        - "Regular scanning schedule established"
        - "Basic SLAs defined"
        - "Vulnerability tracking tool in place"
      currentState: false

    - level: 3
      name: "Defined"
      characteristics:
        - "Comprehensive scanning across all asset types"
        - "Risk-based prioritization"
        - "Automated workflows and reporting"
        - "SLA compliance tracked"
      currentState: true  # CURRENT STATE

    - level: 4
      name: "Managed"
      characteristics:
        - "Continuous monitoring and scanning"
        - "Automated remediation where possible"
        - "Predictive analytics for vulnerability trends"
        - "Integration with threat intelligence"
      currentState: false
      targetDate: "2025-Q4"

    - level: 5
      name: "Optimized"
      characteristics:
        - "AI/ML-driven vulnerability prediction"
        - "Self-healing infrastructure"
        - "Zero-day response within hours"
        - "Industry-leading MTTR"
      currentState: false
      targetDate: "2027-Q2"

  improvementInitiatives:
    - initiative: "Automate Patch Deployment"
      description: "Implement automated patching for non-critical systems"
      status: "In Progress"
      target: "Q3 2024"
      owner: "IT Operations"

    - initiative: "CISA KEV Integration"
      description: "Auto-escalate vulnerabilities on CISA KEV list to P0"
      status: "Planned"
      target: "Q4 2024"
      owner: "Security Operations"

    - initiative: "Vulnerability Prediction"
      description: "Implement EPSS scoring for exploit prediction"
      status: "In Progress"
      target: "Q2 2024"
      owner: "Security Engineering"

    - initiative: "Container Admission Control"
      description: "Block deployment of container images with critical vulns"
      status: "Completed"
      completionDate: "2024-02-01"

  lessonsLearned:
    - incident: "Log4Shell (CVE-2021-44228)"
      date: "2021-12-10"
      impact: "Critical RCE in Log4j library used across 45 applications"
      response: "Emergency patching completed in 72 hours"
      improvements:
        - "Implemented dependency inventory (SBOM)"
        - "Added Snyk for real-time dependency monitoring"
        - "Established emergency patch process"

    - incident: "Spring4Shell (CVE-2022-22965)"
      date: "2022-03-31"
      impact: "RCE in Spring Framework"
      response: "Identified affected apps in 6 hours via SBOM, patched in 24 hours"
      improvements:
        - "SBOM proved critical for rapid response"
        - "WAF rules deployed as temporary mitigation"

# ============================================================================
# APPROVALS
# ============================================================================

approvals:
  - role: "CISO"
    name: ""
    approvalDate: null
    status: "Pending"

  - role: "VP Engineering"
    name: ""
    approvalDate: null
    status: "Pending"

  - role: "VP Infrastructure"
    name: ""
    approvalDate: null
    status: "Pending"

  - role: "Compliance Officer"
    name: ""
    approvalDate: null
    status: "Pending"

# ============================================================================
# CHANGE HISTORY
# ============================================================================

changeHistory:
  - version: "1.0.0"
    date: "YYYY-MM-DD"
    author: "Security Operations Team"
    changes: |
      Initial version of Vulnerability Management Plan including:
      - Scanning schedules for infrastructure, applications, containers, cloud
      - CVSS 3.1 scoring and risk-based prioritization framework
      - Remediation SLAs: Critical (7d), High (30d), Medium (90d), Low (180d)
      - Exception process and compensating controls
      - Metrics and KPI definitions
