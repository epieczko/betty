# Security Detections Catalog
# A comprehensive catalog of security detection rules, use cases, and monitoring capabilities
# Aligned with MITRE ATT&CK Framework, NIST CSF, and industry best practices

metadata:
  version: "2.1.0"
  created: "2024-01-15"
  lastModified: "2024-10-26"
  status: "Active"
  owner: "Security Operations Center"
  classification: "Confidential"

  catalog_info:
    total_detections: 156
    coverage_percentage: 78
    last_tuning_date: "2024-10-15"
    next_review_date: "2024-11-26"
    false_positive_rate: "2.3%"

  approvers:
    - name: "Sarah Chen"
      role: "CISO"
      date: "2024-10-20"
    - name: "Marcus Rodriguez"
      role: "SOC Manager"
      date: "2024-10-19"

# Detection Use Cases organized by MITRE ATT&CK Tactics
detections:
  # ============================================
  # Initial Access (TA0001)
  # ============================================
  - detection_id: "DET-IA-001"
    name: "Brute Force Authentication Attempts"
    description: "Detects multiple failed login attempts from single source IP within short timeframe"

    tactics:
      - "TA0001 - Initial Access"

    techniques:
      - "T1110.001 - Password Guessing"
      - "T1110.003 - Password Spraying"

    data_sources:
      - "Authentication Logs"
      - "VPN Access Logs"
      - "Application Logs"

    detection_logic: |
      SELECT source_ip, username, COUNT(*) as failed_attempts
      FROM authentication_events
      WHERE event_type = 'failed_login'
        AND timestamp > NOW() - INTERVAL '5 minutes'
      GROUP BY source_ip, username
      HAVING COUNT(*) >= 5

    sigma_rule: |
      title: Multiple Failed Login Attempts
      id: 0aaeda67-4c96-4c9e-a564-dd9d56b8ee44
      status: stable
      description: Detects brute force authentication attempts
      references:
        - https://attack.mitre.org/techniques/T1110/
      author: SOC Team
      date: 2024/01/15
      logsource:
        category: authentication
        product: windows
      detection:
        selection:
          EventID: 4625
        timeframe: 5m
        condition: selection | count(Computer) by TargetUserName > 5
      falsepositives:
        - User forgotten password scenarios
        - Automated service accounts misconfiguration
      level: high

    splunk_query: |
      index=auth action=failure
      | bucket _time span=5m
      | stats count by _time, src_ip, user
      | where count >= 5
      | eval severity="high"

    elastic_query: |
      {
        "query": {
          "bool": {
            "must": [
              {"match": {"event.action": "authentication_failure"}},
              {"range": {"@timestamp": {"gte": "now-5m"}}}
            ]
          }
        },
        "aggs": {
          "failed_by_ip": {
            "terms": {"field": "source.ip"},
            "aggs": {
              "user_count": {
                "cardinality": {"field": "user.name"}
              }
            }
          }
        }
      }

    severity: "High"
    priority: 1

    response_actions:
      - "Block source IP at firewall for 1 hour"
      - "Alert SOC analyst for investigation"
      - "Check for successful logins from same IP"
      - "Validate user account status"

    tuning_notes: "Exclude service accounts: svc-*, sa-*. Whitelist corporate VPN gateway IPs."

    false_positive_rate: "3%"

    sla:
      detection_time: "< 5 minutes"
      response_time: "< 15 minutes"
      investigation_time: "< 1 hour"

    testing:
      last_tested: "2024-10-10"
      test_status: "Passed"
      test_method: "Automated purple team simulation"

  - detection_id: "DET-IA-002"
    name: "Phishing Email with Malicious Attachment"
    description: "Detects emails with suspicious attachments or links matching phishing indicators"

    tactics:
      - "TA0001 - Initial Access"

    techniques:
      - "T1566.001 - Spearphishing Attachment"
      - "T1566.002 - Spearphishing Link"

    data_sources:
      - "Email Gateway Logs"
      - "Sandbox Analysis Results"
      - "URL Reputation Feeds"

    detection_logic: |
      SELECT
        sender_email,
        recipient_email,
        subject,
        attachment_hash,
        url_list
      FROM email_events
      WHERE (
        attachment_type IN ('exe', 'scr', 'vbs', 'js', 'hta', 'iso')
        OR attachment_hash IN (SELECT hash FROM threat_intel_iocs WHERE type='malicious')
        OR url_reputation_score < 30
        OR subject LIKE '%urgent%invoice%'
        OR subject LIKE '%password%reset%'
      )

    sigma_rule: |
      title: Suspicious Email Attachment
      id: 8b2a6a5f-9c7d-4e1a-b3f2-c5d6e7f8g9h0
      status: stable
      description: Detects emails with potentially malicious attachments
      logsource:
        product: email_gateway
        service: security
      detection:
        selection_attachment:
          attachment.extension:
            - 'exe'
            - 'scr'
            - 'vbs'
            - 'js'
            - 'bat'
            - 'cmd'
            - 'hta'
            - 'iso'
        selection_sender:
          sender.domain_reputation: '<30'
        condition: selection_attachment OR selection_sender
      level: medium

    splunk_query: |
      index=email_gateway
      (file_extension IN (exe, scr, vbs, js, hta, iso) OR url_reputation<30)
      | eval risk_score=case(
          file_extension="exe", 10,
          url_reputation<20, 8,
          1=1, 5)
      | where risk_score >= 7

    severity: "Medium"
    priority: 2

    response_actions:
      - "Quarantine email automatically"
      - "Alert user via security awareness notification"
      - "Submit attachment to sandbox for analysis"
      - "Add hash to block list if malicious"

    tuning_notes: "Whitelist trusted software vendors. Reduce noise from marketing emails."
    false_positive_rate: "8%"

    sla:
      detection_time: "< 2 minutes"
      response_time: "< 5 minutes"

  # ============================================
  # Execution (TA0002)
  # ============================================
  - detection_id: "DET-EX-001"
    name: "PowerShell Encoded Command Execution"
    description: "Detects obfuscated PowerShell commands often used by attackers"

    tactics:
      - "TA0002 - Execution"

    techniques:
      - "T1059.001 - PowerShell"
      - "T1027 - Obfuscated Files or Information"

    data_sources:
      - "PowerShell Logs (EventID 4103, 4104)"
      - "Sysmon Logs (EventID 1)"
      - "EDR Telemetry"

    detection_logic: |
      SELECT
        computer_name,
        user_name,
        command_line,
        parent_process
      FROM process_events
      WHERE process_name = 'powershell.exe'
        AND (
          command_line LIKE '%-encodedcommand%'
          OR command_line LIKE '%-enc%'
          OR command_line LIKE '%frombase64%'
          OR command_line LIKE '%-w hidden%'
          OR command_line LIKE '%-nop%'
        )

    sigma_rule: |
      title: Suspicious PowerShell Encoded Command
      id: a4e3a5b6-7c8d-9e0f-1a2b-3c4d5e6f7a8b
      status: stable
      description: Detects Base64 encoded PowerShell commands
      references:
        - https://attack.mitre.org/techniques/T1059/001/
      logsource:
        product: windows
        service: powershell
      detection:
        selection_encoded:
          ScriptBlockText|contains:
            - '-encodedcommand'
            - '-enc '
            - 'FromBase64String'
        selection_hidden:
          ScriptBlockText|contains:
            - '-w hidden'
            - '-windowstyle hidden'
        selection_bypass:
          ScriptBlockText|contains:
            - '-nop'
            - '-noprofile'
            - '-executionpolicy bypass'
        condition: selection_encoded OR (selection_hidden AND selection_bypass)
      falsepositives:
        - Legitimate administrative scripts
        - Software deployment tools
      level: high

    splunk_query: |
      index=windows source="WinEventLog:Microsoft-Windows-PowerShell/Operational" EventCode=4104
      (CommandLine="*-enc*" OR CommandLine="*-encodedcommand*" OR CommandLine="*FromBase64*")
      | rex field=CommandLine "(?<encoded_portion>[A-Za-z0-9+/=]{100,})"
      | eval decoded=base64decode(encoded_portion)
      | table _time, Computer, User, CommandLine, decoded

    severity: "Critical"
    priority: 1

    response_actions:
      - "Isolate endpoint immediately"
      - "Capture memory dump for forensics"
      - "Kill PowerShell process"
      - "Escalate to Incident Response team"

    tuning_notes: "Whitelist specific administrative scripts by hash. Monitor exceptions closely."
    false_positive_rate: "1%"

  # ============================================
  # Persistence (TA0003)
  # ============================================
  - detection_id: "DET-PE-001"
    name: "New Scheduled Task Creation"
    description: "Detects creation of scheduled tasks that may be used for persistence"

    tactics:
      - "TA0003 - Persistence"

    techniques:
      - "T1053.005 - Scheduled Task"

    data_sources:
      - "Windows Event Logs (EventID 4698)"
      - "Sysmon (EventID 1)"

    detection_logic: |
      SELECT
        task_name,
        task_command,
        task_author,
        run_as_user,
        trigger_type,
        creation_time
      FROM scheduled_tasks
      WHERE creation_time > NOW() - INTERVAL '1 hour'
        AND (
          task_command LIKE '%powershell%'
          OR task_command LIKE '%cmd.exe%'
          OR task_command LIKE '%wscript%'
          OR task_command LIKE '%cscript%'
          OR task_command LIKE '%regsvr32%'
        )
        AND run_as_user IN ('SYSTEM', 'Administrator')

    sigma_rule: |
      title: Suspicious Scheduled Task Creation
      id: b5c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
      status: stable
      description: Detects scheduled tasks created with suspicious properties
      logsource:
        product: windows
        service: security
      detection:
        selection:
          EventID: 4698
        filter_command:
          TaskContent|contains:
            - 'powershell'
            - 'cmd.exe'
            - 'wscript'
            - 'regsvr32'
            - 'rundll32'
        condition: selection AND filter_command
      level: medium

    severity: "Medium"
    priority: 2

    response_actions:
      - "Review task details and author"
      - "Disable task if unauthorized"
      - "Check for related IOCs"
      - "Interview task creator if internal user"

    false_positive_rate: "12%"

  # ============================================
  # Privilege Escalation (TA0004)
  # ============================================
  - detection_id: "DET-PR-001"
    name: "Suspicious Service Installation"
    description: "Detects installation of new Windows services with unusual properties"

    tactics:
      - "TA0004 - Privilege Escalation"
      - "TA0003 - Persistence"

    techniques:
      - "T1543.003 - Windows Service"

    data_sources:
      - "System Event Log (EventID 7045)"
      - "Sysmon (EventID 11, 13)"

    detection_logic: |
      SELECT
        service_name,
        service_file_path,
        service_type,
        start_type,
        service_account
      FROM service_events
      WHERE event_type = 'service_installed'
        AND (
          service_file_path LIKE '%temp%'
          OR service_file_path LIKE '%appdata%'
          OR service_file_path LIKE '%programdata%'
          OR service_account = 'LocalSystem'
        )

    severity: "High"
    priority: 1

    response_actions:
      - "Stop and disable service"
      - "Quarantine service binary"
      - "Scan with AV/EDR"
      - "Check service creator credentials"

  # ============================================
  # Defense Evasion (TA0005)
  # ============================================
  - detection_id: "DET-DE-001"
    name: "Windows Defender Tampering"
    description: "Detects attempts to disable or modify Windows Defender configuration"

    tactics:
      - "TA0005 - Defense Evasion"

    techniques:
      - "T1562.001 - Disable or Modify Tools"

    data_sources:
      - "Windows Event Logs"
      - "Registry Monitoring"
      - "PowerShell Logs"

    detection_logic: |
      SELECT
        computer_name,
        user_name,
        action_type,
        registry_key,
        command_line
      FROM security_events
      WHERE (
        registry_key LIKE '%Windows Defender%DisableAntiSpyware%'
        OR command_line LIKE '%Set-MpPreference%DisableRealtimeMonitoring%'
        OR service_name = 'WinDefend' AND service_state = 'stopped'
      )

    sigma_rule: |
      title: Windows Defender Disabled via Registry
      id: c6d9e0f1-2a3b-4c5d-6e7f-8a9b0c1d2e3f
      status: stable
      description: Detects registry modification to disable Windows Defender
      logsource:
        product: windows
        category: registry_event
      detection:
        selection:
          TargetObject|contains: 'Windows Defender'
          Details|contains: 'DisableAntiSpyware'
          EventType: 'SetValue'
        condition: selection
      level: critical

    severity: "Critical"
    priority: 1

    response_actions:
      - "Immediately re-enable Windows Defender"
      - "Isolate affected endpoint"
      - "Full malware scan"
      - "Forensic investigation"

  # ============================================
  # Credential Access (TA0006)
  # ============================================
  - detection_id: "DET-CA-001"
    name: "Mimikatz Credential Dumping"
    description: "Detects indicators of Mimikatz or similar credential dumping tools"

    tactics:
      - "TA0006 - Credential Access"

    techniques:
      - "T1003.001 - LSASS Memory"
      - "T1003.002 - Security Account Manager"

    data_sources:
      - "Sysmon (EventID 10)"
      - "EDR Telemetry"
      - "Windows Security Logs (EventID 4656, 4663)"

    detection_logic: |
      SELECT
        source_process,
        target_process,
        access_mask,
        computer_name,
        user_name
      FROM process_access_events
      WHERE target_process = 'lsass.exe'
        AND (
          access_mask = '0x1010'
          OR access_mask = '0x1410'
          OR access_mask = '0x1438'
        )
        AND source_process NOT IN (
          'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe',
          'C:\\Windows\\System32\\svchost.exe',
          'C:\\Program Files\\CrowdStrike\\*'
        )

    sigma_rule: |
      title: LSASS Memory Access by Suspicious Process
      id: d7f8e9a0-1b2c-3d4e-5f6a-7b8c9d0e1f2a
      status: stable
      description: Detects suspicious access to LSASS process memory
      references:
        - https://attack.mitre.org/techniques/T1003/001/
      logsource:
        product: windows
        category: process_access
      detection:
        selection:
          TargetImage|endswith: '\\lsass.exe'
          GrantedAccess|contains:
            - '0x1010'
            - '0x1410'
            - '0x1438'
            - '0x143a'
        filter:
          SourceImage|startswith:
            - 'C:\\Windows\\System32\\'
            - 'C:\\Program Files\\Windows Defender\\'
        condition: selection AND NOT filter
      falsepositives:
        - Legitimate security tools
        - System diagnostics
      level: critical

    severity: "Critical"
    priority: 1

    response_actions:
      - "IMMEDIATE: Isolate endpoint from network"
      - "Force password reset for all users on affected system"
      - "Memory dump for forensic analysis"
      - "Hunt for lateral movement indicators"
      - "Engage Incident Response team"

    tuning_notes: "Highly sensitive detection. Review all alerts immediately."
    false_positive_rate: "0.5%"

  # ============================================
  # Discovery (TA0007)
  # ============================================
  - detection_id: "DET-DI-001"
    name: "Network Scanning Activity"
    description: "Detects port scanning or network enumeration behavior"

    tactics:
      - "TA0007 - Discovery"

    techniques:
      - "T1046 - Network Service Discovery"
      - "T1018 - Remote System Discovery"

    data_sources:
      - "Network Flow Logs"
      - "Firewall Logs"
      - "IDS/IPS Alerts"

    detection_logic: |
      SELECT
        source_ip,
        COUNT(DISTINCT dest_port) as port_count,
        COUNT(DISTINCT dest_ip) as ip_count
      FROM network_connections
      WHERE timestamp > NOW() - INTERVAL '1 minute'
      GROUP BY source_ip
      HAVING port_count > 25 OR ip_count > 50

    severity: "Medium"
    priority: 3

    response_actions:
      - "Identify source system"
      - "Check for authorized security scanning"
      - "Block if malicious"
      - "Alert network security team"

  # ============================================
  # Lateral Movement (TA0008)
  # ============================================
  - detection_id: "DET-LM-001"
    name: "SMB Lateral Movement Detection"
    description: "Detects suspicious SMB connections indicating lateral movement"

    tactics:
      - "TA0008 - Lateral Movement"

    techniques:
      - "T1021.002 - SMB/Windows Admin Shares"
      - "T1570 - Lateral Tool Transfer"

    data_sources:
      - "Windows Security Logs (EventID 5140, 5145)"
      - "Network Traffic Analysis"

    detection_logic: |
      SELECT
        source_ip,
        dest_ip,
        share_name,
        user_name,
        access_type
      FROM smb_connections
      WHERE share_name IN ('C$', 'ADMIN$', 'IPC$')
        AND user_name NOT LIKE 'NT AUTHORITY%'
        AND source_ip != dest_ip
      GROUP BY source_ip, user_name
      HAVING COUNT(DISTINCT dest_ip) >= 5

    severity: "High"
    priority: 1

    response_actions:
      - "Validate user activity"
      - "Check for compromised credentials"
      - "Review authentication logs"
      - "Isolate if malicious"

  # ============================================
  # Collection (TA0009)
  # ============================================
  - detection_id: "DET-CO-001"
    name: "Sensitive Data Staging"
    description: "Detects collection of sensitive files into staging directories"

    tactics:
      - "TA0009 - Collection"

    techniques:
      - "T1074.001 - Local Data Staging"

    data_sources:
      - "File System Monitoring"
      - "DLP Logs"
      - "EDR Telemetry"

    detection_logic: |
      SELECT
        user_name,
        destination_path,
        COUNT(*) as file_count,
        SUM(file_size) as total_size
      FROM file_operations
      WHERE operation = 'copy'
        AND (
          file_name LIKE '%.xlsx'
          OR file_name LIKE '%.docx'
          OR file_name LIKE '%.pdf'
          OR file_name LIKE '%.pst'
        )
        AND destination_path LIKE '%temp%'
      GROUP BY user_name, destination_path
      HAVING COUNT(*) > 100 OR total_size > 100000000

    severity: "High"
    priority: 2

  # ============================================
  # Exfiltration (TA0010)
  # ============================================
  - detection_id: "DET-EX-002"
    name: "Large Data Upload to Cloud Storage"
    description: "Detects unusually large uploads to cloud storage services"

    tactics:
      - "TA0010 - Exfiltration"

    techniques:
      - "T1567.002 - Exfiltration to Cloud Storage"

    data_sources:
      - "Web Proxy Logs"
      - "DLP Alerts"
      - "Network Traffic Analysis"

    detection_logic: |
      SELECT
        user_name,
        destination_domain,
        SUM(bytes_uploaded) as total_upload
      FROM web_proxy_logs
      WHERE destination_domain IN (
        'drive.google.com',
        'dropbox.com',
        'onedrive.live.com',
        'wetransfer.com',
        'mega.nz',
        'box.com'
      )
      AND timestamp > NOW() - INTERVAL '1 hour'
      GROUP BY user_name, destination_domain
      HAVING total_upload > 100000000

    severity: "Critical"
    priority: 1

    response_actions:
      - "Block upload if in progress"
      - "Contact user immediately"
      - "Review DLP logs for content"
      - "Engage legal if data breach suspected"
      - "Document for compliance reporting"

  # ============================================
  # Command and Control (TA0011)
  # ============================================
  - detection_id: "DET-CC-001"
    name: "Beaconing Behavior Detection"
    description: "Detects periodic network connections consistent with C2 beaconing"

    tactics:
      - "TA0011 - Command and Control"

    techniques:
      - "T1071 - Application Layer Protocol"
      - "T1573 - Encrypted Channel"

    data_sources:
      - "Network Flow Logs"
      - "Firewall Logs"
      - "DNS Logs"

    detection_logic: |
      WITH connection_intervals AS (
        SELECT
          source_ip,
          dest_ip,
          dest_port,
          timestamp,
          LEAD(timestamp) OVER (
            PARTITION BY source_ip, dest_ip, dest_port
            ORDER BY timestamp
          ) - timestamp as interval
        FROM network_connections
      )
      SELECT
        source_ip,
        dest_ip,
        dest_port,
        AVG(interval) as avg_interval,
        STDDEV(interval) as stddev_interval,
        COUNT(*) as connection_count
      FROM connection_intervals
      WHERE interval IS NOT NULL
      GROUP BY source_ip, dest_ip, dest_port
      HAVING COUNT(*) >= 10
        AND stddev_interval < avg_interval * 0.1

    sigma_rule: |
      title: Potential C2 Beaconing Activity
      id: e1f2a3b4-5c6d-7e8f-9a0b-1c2d3e4f5a6b
      status: experimental
      description: Detects periodic network connections consistent with beaconing
      logsource:
        category: firewall
      detection:
        selection:
          action: allowed
          protocol: tcp
        timeframe: 1h
        condition: selection | count() by src_ip, dst_ip, dst_port > 10
      level: high

    severity: "High"
    priority: 1

    response_actions:
      - "Capture full packet capture for analysis"
      - "Block destination IP at firewall"
      - "Isolate source system"
      - "Forensic analysis of endpoint"
      - "Check threat intelligence for destination IP"

# Detection Coverage Metrics
coverage_metrics:
  mitre_attack_coverage:
    initial_access: "85%"
    execution: "90%"
    persistence: "75%"
    privilege_escalation: "80%"
    defense_evasion: "70%"
    credential_access: "88%"
    discovery: "65%"
    lateral_movement: "82%"
    collection: "60%"
    exfiltration: "78%"
    command_and_control: "80%"
    impact: "55%"

  overall_coverage: "75%"

  coverage_gaps:
    - technique: "T1195 - Supply Chain Compromise"
      gap_description: "Limited visibility into build pipeline"
      remediation_plan: "Implement SBOM and build attestation monitoring"
      target_date: "2024-12-31"

    - technique: "T1552.004 - Private Keys"
      gap_description: "No monitoring for private key access"
      remediation_plan: "Deploy Vault audit logging and alerting"
      target_date: "2024-11-30"

# Detection Engineering Standards
detection_standards:
  naming_convention: "DET-[TACTIC_CODE]-[SEQUENCE]"

  severity_levels:
    critical: "Immediate threat requiring instant response"
    high: "Significant risk requiring urgent attention"
    medium: "Notable risk requiring timely review"
    low: "Informational or low-risk activity"
    informational: "Contextual awareness only"

  required_fields:
    - detection_id
    - name
    - description
    - tactics
    - techniques
    - data_sources
    - detection_logic
    - severity
    - response_actions

  testing_requirements:
    frequency: "Quarterly"
    methods:
      - "Automated purple team simulations"
      - "Manual playbook validation"
      - "Production telemetry validation"

    acceptance_criteria:
      - "Detection triggers within defined SLA"
      - "False positive rate below threshold"
      - "Alert contains actionable context"

# Tuning and Maintenance
tuning_process:
  review_frequency: "Monthly"

  false_positive_handling:
    threshold: "5%"
    process: |
      1. Document false positive pattern
      2. Create exclusion rule with business justification
      3. Update detection logic or add filter
      4. Test modified detection
      5. Document tuning in change history

  detection_lifecycle:
    stages:
      - "Development: Initial rule creation and testing"
      - "Testing: Purple team validation in non-prod"
      - "Pilot: Limited production deployment"
      - "Production: Full deployment with monitoring"
      - "Mature: Optimized and stable"
      - "Deprecated: Replaced or no longer relevant"

  retirement_criteria:
    - "Technology no longer in use"
    - "Superseded by better detection"
    - "Consistent false positive rate > 20%"
    - "Data source no longer available"

# Integration with Security Tools
integrations:
  siem_platforms:
    - name: "Splunk Enterprise Security"
      version: "7.1.2"
      deployment: "Production"
      integration_method: "API + Forwarders"

    - name: "Elastic Security"
      version: "8.10.0"
      deployment: "Production"
      integration_method: "Elastic Agent + Fleet"

  soar_platform:
    name: "Palo Alto Cortex XSOAR"
    version: "6.10.0"
    playbook_integration: true
    automated_response_enabled: true

  threat_intelligence:
    - source: "MISP"
      feed_type: "IOC Enrichment"
      update_frequency: "Hourly"

    - source: "AlienVault OTX"
      feed_type: "Threat Context"
      update_frequency: "Daily"

    - source: "VirusTotal Enterprise"
      feed_type: "File/URL Reputation"
      update_frequency: "Real-time"

# Performance Metrics
performance:
  detection_statistics:
    total_alerts_last_30_days: 4567
    true_positives: 156
    false_positives: 104
    benign_positives: 234
    under_investigation: 89

    precision: "60%"
    recall: "87%"

    mean_time_to_detect: "4.2 minutes"
    mean_time_to_respond: "18.5 minutes"
    mean_time_to_remediate: "2.3 hours"

  analyst_efficiency:
    avg_alerts_per_analyst_per_day: 45
    avg_investigation_time: "12 minutes"
    escalation_rate: "15%"

# Compliance Mapping
compliance_alignment:
  nist_csf:
    - function: "DE.CM-1"
      description: "Network monitored to detect potential cybersecurity events"
      detections: ["DET-DI-001", "DET-CC-001", "DET-LM-001"]

    - function: "DE.CM-7"
      description: "Monitoring for unauthorized personnel, connections, devices, and software"
      detections: ["DET-IA-001", "DET-PE-001", "DET-PR-001"]

    - function: "DE.AE-2"
      description: "Detected events are analyzed to understand attack targets and methods"
      detections: ["ALL"]

  pci_dss:
    - requirement: "10.6"
      description: "Review logs and security events"
      detections: ["DET-IA-001", "DET-CA-001"]

    - requirement: "11.4"
      description: "Use intrusion-detection and/or intrusion-prevention techniques"
      detections: ["ALL"]

  iso_27001:
    - control: "A.12.4.1"
      description: "Event logging"
      detections: ["ALL"]

    - control: "A.16.1.2"
      description: "Reporting information security events"
      detections: ["ALL"]

# Change History
change_history:
  - version: "2.1.0"
    date: "2024-10-26"
    author: "Michael Torres - SOC Lead"
    changes: |
      - Added 5 new detections for cloud infrastructure
      - Updated MITRE ATT&CK mappings to v14
      - Enhanced Sigma rules with better filtering
      - Improved false positive tuning for brute force detection
    approver: "Sarah Chen - CISO"

  - version: "2.0.0"
    date: "2024-07-15"
    author: "Jennifer Kim - Detection Engineer"
    changes: |
      - Major restructure aligned to MITRE ATT&CK framework
      - Added Sigma rules for all high/critical detections
      - Implemented standardized detection ID scheme
      - Added compliance mapping section
    approver: "Sarah Chen - CISO"

  - version: "1.0.0"
    date: "2024-01-15"
    author: "Marcus Rodriguez - SOC Manager"
    changes: "Initial catalog creation with 85 base detections"
    approver: "Sarah Chen - CISO"
